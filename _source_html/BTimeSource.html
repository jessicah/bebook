<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>The Be Book - Classes And Methods - The Media Kit</title><link rel="stylesheet" href="be_book.css" type="text/css" media="all" /><link rel="shortcut icon" type="image/vnd.microsoft.icon" href="./images/favicon.ico" /><!--[if IE]>
    <link rel="stylesheet" type="text/css" href="be_book_ie.css" />
    <![endif]--><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><meta name="keywords" content="Access, BeOS, BeBook, API" /><link rel="start" href="index.html" title="The Be Book" /><link rel="up" href="TheMediaKit.html" title="The Media Kit" /><link rel="prev" href="BTimedEventQueue.html" title="BTimedEventQueue" /><link rel="next" href="TheMediaKit_Functions.html" title="Functions" /></head><body><div id="header"><div id="headerT"><div id="headerTL"><a accesskey="p" href="BTimedEventQueue.html" title="BTimedEventQueue"><img src="./images/navigation/prev.png" alt="Prev" /></a> <a accesskey="u" href="TheMediaKit.html" title="The Media Kit"><img src="./images/navigation/up.png" alt="Up" /></a> <a accesskey="n" href="TheMediaKit_Functions.html" title="Functions"><img src="./images/navigation/next.png" alt="Next" /></a></div><div id="headerTR"><div id="navigpeople"><a href="http://www.haiku-os.org"><img src="./images/People_24.png" alt="haiku-os.org" title="Visit The Haiku Website" /></a></div><div class="navighome" title="Home"><a accesskey="h" href="index.html"><img src="./images/navigation/home.png" alt="Home" /></a></div><div class="navigboxed" id="navigindex"><a accesskey="i" href="ClassIndex.html" title="Index">I</a></div><div class="navigboxed" id="naviglang" title="English">en</div></div><div id="headerTC">The Be Book - Classes And Methods - The Media Kit</div></div><div id="headerB">Prev: <a href="BTimedEventQueue.html">BTimedEventQueue</a>  Up: <a href="TheMediaKit.html">The Media Kit</a>  Next: <a href="TheMediaKit_Functions.html">Functions</a></div><hr /></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h2 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource"></a>BTimeSource</h2></div></div></div><a id="id1176792" class="indexterm"></a><div class="classheader"><table border="0"><colgroup><col /><col /></colgroup><tbody><tr><td><table width="100%" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td>Derived From:</td><td>–</td></tr><tr><td>Mix-in Classes:</td><td>–</td></tr><tr><td>Declared In:</td><td><code class="filename">media/TimeSource.h</code></td></tr><tr><td>Library:</td><td><code class="filename">libmedia.so</code></td></tr><tr><td>Allocation:</td><td>Constructor only</td></tr></tbody></table></td><td>
<a class="link overview" href="BTimeSource_Overview.html" title="BTimeSource">Class Overview</a>
<div class="toc"><ul><li><span class="section"><a href="BTimeSource.html#BTimeSource_ConstructorDestructor">Constructor and Destructor</a></span></li><li><span class="section"><a href="BTimeSource.html#BTimeSource_MemberFunctions">Member Functions</a></span></li><li><span class="section"><a href="BTimeSource.html#BTimeSource_Constants">Constants</a></span></li><li><span class="section"><a href="BTimeSource.html#BTimeSource_DefinedTypes">Defined Types</a></span></li></ul></div>
</td></tr></tbody></table></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><hr /><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_ConstructorDestructor"></a>Constructor and Destructor</h3></div></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_Constructor"></a>BTimeSource()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="constructorsynopsis cpp"><span class="methodname">BTimeSource</span>();</code><p>The standard <code class="classname">BTimeSource</code> constructor. You should never directly
instantiate a <code class="classname">BTimeSource</code>; instead, you should create a node class
derived from <code class="classname">BTimeSource</code> (and possibly other
<a class="link" href="BMediaNode.html" title="BMediaNode"><code class="classname">BMediaNode</code></a>-derived
classes as well) and use the
<a class="link" href="BMediaRoster.html" title="BMediaRoster"><code class="classname">BMediaRoster</code></a>
to instantiate the node as desired.</p></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><hr /><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_MemberFunctions"></a>Member Functions</h3></div></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_BroadcastTimeWarp"></a>BroadcastTimeWarp()</h4></div></div></div><code class="methodsynopsis cpp"><span class="void">void </span><span class="methodname">BroadcastTimeWarp</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">atRealTime</span></span>,<br />                       <span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">newPerformanceTime</span></span>);</code><p>Whenever time jumps suddenly (for instance, when a seek operation
occurs), call this function to inform all slaved nodes that time has
jumped in a discontinuous manner. You should also call this function if
the time from which your time source derives its time jumps.</p><p>At the real time specified by <code class="parameter">atRealTime</code>, the performance time will
instantaneously jump to <code class="parameter">newPerformanceTime</code>.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_GetStartLatency"></a>GetStartLatency()</h4></div></div></div><code class="methodsynopsis cpp"><span class="type">status_t </span><span class="methodname">GetStartLatency</span>(<span class="methodparam"><span class="type">bigtime_t* </span><span class="parameter">outLatency</span></span>);</code><p>Returns in <code class="parameter">outLatency</code> the amount of time, in microseconds, needed for the
time source to start up, including the time needed to start up any slaved
nodes that are started.</p><table class="variablelist returncodes"><thead><tr><th>Return Code</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="constant">B_OK</code></span></p></td><td><p>The latency value was returned successfully.</p></td></tr><tr><td><p><span class="term"><code class="constant">B_NO_INIT</code></span></p></td><td><p>The time source has not been initialized.</p></td></tr></tbody></table></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_GetTime"></a>GetTime()</h4></div></div></div><code class="methodsynopsis cpp"><span class="type">status_t </span><span class="methodname">GetTime</span>(<span class="methodparam"><span class="type">bigtime_t* </span><span class="parameter">performanceTime</span></span>,<br />                 <span class="methodparam"><span class="type">bigtime_t* </span><span class="parameter">realTime</span></span>,<br />                 <span class="methodparam"><span class="type">float* </span><span class="parameter">drift</span></span>);</code><p>Returns the most recently published time information for this time
source; this information specifies the performance time and real time of
the last published time stamp, as well as the <code class="parameter">drift</code> value, which can be
used to interpolate the true current performance time, given a more
accurate real time, as follows:</p><pre class="programlisting cpp"><span class="type">bigtime_t</span> <code class="varname">performanceTime</code>;
<span class="type">bigtime_t</span> <code class="varname">realTime</code>;
<span class="type">float</span> <code class="varname">drift</code>;

while (<code class="methodname">GetTime</code>(&amp;<code class="varname">performanceTime</code>, &amp;<code class="varname">realTime</code>, &amp;<code class="varname">drift</code>) != <code class="constant">B_OK</code>);
<code class="varname">performanceTime</code> = <code class="varname">performanceTime</code> + (<code class="methodname">RealTime</code>() - <code class="varname">realTime</code>) * <code class="varname">drift</code>;</pre><p>Note, however, that the resulting
<code class="parameter">performanceTime</code> is the same value you would have
gotten by calling <code class="methodname">PerformanceTimeFor()</code>, which
you should use instead.</p><table class="variablelist returncodes"><thead><tr><th>Return Code</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="constant">B_OK</code></span></p></td><td><p>The returned information is accurate.</p></td></tr><tr><td><p><span class="term">Other values.</span></p></td><td><p>The returned information is unreliable.</p></td></tr></tbody></table></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_HandleMessage"></a>HandleMessage()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="type">status_t </span><span class="methodname">HandleMessage</span>(<span class="methodparam"><span class="type">int32 </span><span class="parameter">code</span></span>,<br />                       <span class="methodparam"><span class="modifier">const </span><span class="type">void* </span><span class="parameter">message</span></span>,<br />                       <span class="methodparam"><span class="type">size_t </span><span class="parameter">size</span></span>);</code><p>Given a <code class="parameter">message</code> received on the control
port, this function dispatches the message to the appropriate
<code class="classname">BTimeSource</code> hook function. If the message
doesn't correspond to a hook function, an appropriate error be
returned.</p><p>If your node derives from <code class="classname">BTimeSource</code>,
your implementation of <code class="methodname">HandleMessage()</code> should
call all inherited forms of
<code class="methodname">HandleMessage()</code>.</p><table class="variablelist returncodes"><thead><tr><th>Return Code</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="constant">B_OK</code></span></p></td><td><p>The message was dispatched.</p></td></tr><tr><td><p><span class="term">Other values.</span></p></td><td><p>The message couldn't be dispatched, possibly because it
doesn't correspond to a hook function.</p></td></tr></tbody></table></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_IsRunning"></a>IsRunning()</h4></div></div></div><code class="methodsynopsis cpp"><span class="type">bool </span><span class="methodname">IsRunning</span>();</code><p>Returns <code class="constant">true</code> if the
<code class="classname">BTimeSource</code> is currently progressing through time or
<code class="constant">false</code> if it's stopped.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_Now"></a><a id="BTimeSource_PerformanceTimeFor"></a>
<a id="BTimeSource_RealTimeFor"></a>
Now(), PerformanceTimeFor(), RealTimeFor()</h4></div></div></div><code class="methodsynopsis cpp"><span class="type">bigtime_t </span><span class="methodname">Now</span>();</code><code class="methodsynopsis cpp"><span class="type">bigtime_t </span><span class="methodname">PerformanceTimeFor</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">realTime</span></span>);</code><code class="methodsynopsis cpp"><span class="type">bigtime_t </span><span class="methodname">PerformanceTimeFor</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">performanceTime</span></span>,<br />                             <span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">withLatency</span></span>);</code><p><code class="methodname">Now()</code> returns an approximation
of what the current performance time is.</p><p><code class="methodname">PerformanceTimeFor()</code> returns
an estimate of the performance time
represented by the specified real time (as returned by
<a class="link" href="BTimeSource.html#BTimeSource_RealTime" title="RealTime()"><code class="methodname">BTimeSource::RealTime()</code></a>).</p><p><code class="methodname">RealTimeFor()</code>, given a
performance time, returns an approximation of the
corresponding real time, adjusted by the given latency.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_PublishTime"></a>PublishTime()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="void">void </span><span class="methodname">PublishTime</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">performanceTime</span></span>,<br />                 <span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">realTime</span></span>,<br />                 <span class="methodparam"><span class="type">float </span><span class="parameter">drift</span></span>);</code><p>While your time source is running, you should repeatedly call this
function in order to constantly refresh the mapping between real time and
performance time. When your time source is stopped, you should call this
function once with values of zero for all three arguments.</p><p>The arguments have the following meanings:</p><table class="variablelist parameters"><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="parameter">performanceTime</code>.</span></p></td><td><p>Is the precise current performance time.</p></td></tr><tr><td><p><span class="term"><code class="parameter">realTime</code>.</span></p></td><td><p>Is the current real time.</p></td></tr><tr><td><p><span class="term"><code class="parameter">drift</code>.</span></p></td><td><p>Indicates the value which indicates the rate at which the
performance time changes compared to real time.</p></td></tr></tbody></table><p>The <code class="parameter">drift</code> value makes it possible to
interpolate intermediate values. For instance, if playback of a video
source is progressing at normal speed, the <code class="parameter">drift</code>
value would be 1.0, indicating that performance time and real time progress
at the same rate.</p><p>However, if the movie is playing at half-speed,
<code class="parameter">drift</code> would be 0.5, so that for every one unit of
real time that passes, only a half-unit of performance time would pass.
This information is used to compute times without having to query the time
source each time an update must occur.</p><p>The data furnished by this function (which you should try to call about
20 times a second, although variations in frequency are acceptable as
long as the drift value doesn't change much) may be the only information
the rest of the world sees from your node.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_RealTime"></a>RealTime()</h4></div></div></div><code class="methodsynopsis cpp"><span class="modifier">static </span><span class="type">bigtime_t </span><span class="methodname">RealTime</span>();</code><p>Returns the current absolute real time reference that all time sources
measure themselves against. This is the only call that you should rely
upon to obtain this value (don't use the Kernel Kit's
<a class="link" href="TheKernelKit_Time.html#system_time" title="system_time()"><code class="function">system_time()</code></a>
function).</p><p>As of this time, <code class="methodname">RealTime()</code> and
<a class="link" href="TheKernelKit_Time.html#system_time" title="system_time()"><code class="function">system_time()</code></a>
do return the same value;
however, you shouldn't rely upon this relationship. When doing media
stuff, you should always use <code class="methodname">RealTime()</code>.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_Seek"></a>Seek()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="modifier">virtual </span><span class="void">void </span><span class="methodname">Seek</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">performanceTime</span></span>,<br />                  <span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">atRealTime</span></span>);</code><p>Implement this function to handle a seek request. When a <code class="classname">BTimeSource</code>'s
performance time is adjusted, it needs to broadcast the change to all
nodes slaved to it; call
<a class="link" href="BTimeSource.html#BTimeSource_BroadcastTimeWarp" title="BroadcastTimeWarp()"><code class="methodname">BroadcastTimeWarp()</code></a>
to do this.</p><p>Be sure to queue at least one seek request, so seek operations can be
requested in advance. The seek request should occur at the real time
specified by <code class="parameter">atRealTime</code>.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_SendRunMode"></a>SendRunMode()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="void">void </span><span class="methodname">SendRunMode</span>(<span class="methodparam"><span class="type">run_mode </span><span class="parameter">mode</span></span>);</code><p>This function transmits the specified mode to all the nodes slaved
to this node, so they know that their time source's run mode has changed.
This function is called by
<a class="link" href="BTimeSource.html#BTimeSource_SetRunMode" title="SetRunMode()"><code class="methodname">SetRunMode()</code></a>;
it may or may not make sense to call it elsewhere, depending on your
<code class="classname">BTimeSource</code> implementation.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_SetRunMode"></a>SetRunMode()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="modifier">virtual </span><span class="void">void </span><span class="methodname">SetRunMode</span>(<span class="methodparam"><span class="type"><a class="link" href="BMediaNode.html#Enums_run_mode" title="run_mode">run_mode</a> </span><span class="parameter">mode</span></span>);</code><p>This hook function is called when someone requests that your node's run
mode be changed. Be sure to call through to either
<a class="link" href="BMediaNode.html#BMediaNode_SetRunMode"><code class="methodname">BMediaNode::SetRunMode()</code></a> or
<code class="methodname">BTimeSource::SetRunMode()</code>.</p></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_SnoozeUntil"></a>SnoozeUntil()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="modifier">virtual </span><span class="void">void </span><span class="methodname">SnoozeUntil</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">performanceTime</span></span>,<br />                         <span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">withLatency</span><span class="initializer"> = 0</span></span>,<br />                         <span class="methodparam"><span class="type">bool </span><span class="parameter">retrySignals</span><span class="initializer"> = <span class="constant">false</span></span></span>);</code><p>Waits until the specified <code class="parameter">performanceTime</code> (specified in performance time)
arrives in real time. If <code class="parameter">withLatency</code> is non-zero, <code class="methodname">SnoozeUntil()</code> waits
until <code class="parameter">withLatency</code> microseconds (in real time) prior to the specified
performance time; this lets you have time for setup prior to starting
some operation.</p><div class="admonition note"><div class="title">Note</div><div class="graphic"><img class="icon" alt="Note" width="32" src="./images/admonitions/Info_32.png" /><div class="text"><p>Because <code class="parameter">performanceTime</code> is specified in
performance time, and <code class="parameter">withLatency</code> is specified
in real time, you can't just subtract
<code class="parameter">withLatency</code> microseconds from
<code class="parameter">performanceTime</code> and snooze until that time,
because <code class="parameter">performanceTime</code> may be passing at a rate
faster than or slower than real time (if, for example, the time source is
running at double-speed).</p></div></div></div><p>If <code class="parameter">retrySignals</code> is
<code class="constant">false</code> (as is the default),
<code class="methodname">SnoozeUntil()</code> returns
<code class="constant">B_INTERRUPTED</code> if it's interrupted by a signal
before <code class="parameter">performanceTime</code>; if
<code class="parameter">retrySignals</code> is <code class="constant">true</code>,
the function will go right back to sleep and not return until the time has
actually arrived.</p><table class="variablelist returncodes"><thead><tr><th>Return Code</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="constant">B_OK</code></span></p></td><td><p>No error; the snooze has completed without incident.</p></td></tr><tr><td><p><span class="term"><code class="constant">B_MEDIA_TIME_SOURCE_STOPPED</code></span></p></td><td><p>The time source is stopped; snoozing on a stopped time
source is a bad thing.</p></td></tr></tbody></table></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_Start"></a>Start()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="modifier">virtual </span><span class="void">void </span><span class="methodname">Start</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">realTime</span></span>);</code><p>This function is called when someone wants the
<code class="classname">BTimeSource</code> to begin running; the
<code class="parameter">realTime</code> argument indicates the real time at
which the time source should start. Implement the function to queue the
request as necessary.</p><p>Be sure to queue at least one start request, so that start requests can
be filed in advance.</p><div class="admonition note"><div class="title">Note</div><div class="graphic"><img class="icon" alt="Note" width="32" src="./images/admonitions/Info_32.png" /><div class="text"><p>A <code class="classname">BTimeSource</code> measures start and stop
times in real time, not in performance time, because
<code class="classname">BTimeSource</code>s are the objects used to perform the
mapping between real time and performance time.</p></div></div></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_Stop"></a>Stop()</h4></div><div xmlns:d="http://docbook.org/ns/docbook"><h5 xmlns="http://www.w3.org/1999/xhtml" class="subtitle">protected</h5></div></div></div><code class="methodsynopsis cpp"><span class="modifier">virtual </span><span class="void">void </span><span class="methodname">Stop</span>(<span class="methodparam"><span class="type">bigtime_t </span><span class="parameter">realTime</span></span>);</code><p><code class="methodname">Stop()</code> is called when someone wants
the <code class="classname">BTimeSource</code> to stop; the
<code class="parameter">realTime</code> argument indicates the real time at
which the time source should stop running. Implement the function to queue
the request.</p><p>Be sure to queue at least one stop request, so stop requests can be
filed in advance.</p><div class="admonition note"><div class="title">Note</div><div class="graphic"><img class="icon" alt="Note" width="32" src="./images/admonitions/Info_32.png" /><div class="text"><p>A <code class="classname">BTimeSource</code> measures start and stop
times in real time, not in performance time, because
<code class="classname">BTimeSource</code>s are the objects used to perform the
mapping between real time and performance time.</p></div></div></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_TimeSourceOp"></a>TimeSourceOp()</h4></div></div></div><code class="methodsynopsis cpp"><span class="modifier">virtual </span><span class="type">status_t </span><span class="methodname">TimeSourceOp</span>(<span class="methodparam"><span class="modifier">const </span><span class="type"><a class="link" href="BTimeSource.html#time_source_op_info" title="time_source_op_info">time_source_op_info</a>&amp; </span><span class="parameter">op</span></span>,<br />                              <span class="methodparam"><span class="type">void* </span><span class="parameter">_reserved</span><span class="initializer"> = 0</span></span>);</code><p>This function is called by the
<a class="link" href="BMediaNode.html#BMediaNode_Start" title="Start()"><code class="methodname">BMediaNode::Start()</code></a>,
<a class="link" href="BMediaNode.html#BMediaNode_Stop" title="Stop()"><code class="methodname">BMediaNode::Stop()</code></a>, and
<a class="link" href="BMediaNode.html#BMediaNode_Seek" title="Seek()"><code class="methodname">BMediaNode::Seek()</code></a>
functions to perform the requested activities.</p><p>You must implement this function to handle these requests.</p><p>Return <code class="constant">B_OK</code> if the request was handled
successfully; otherwise, return an appropriate error code.</p></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><hr /><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_Constants"></a>Constants</h3></div></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="Enums_time_source_op"></a>time_source_op</h4></div></div></div><table class="variablelist constants"><thead><tr><th>Constant</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="constant">B_TIMESOURCE_START</code></span></p></td><td><p>Start the time source.</p></td></tr><tr><td><p><span class="term"><code class="constant">B_TIMESOURCE_STOP</code></span></p></td><td><p>Stop the time source.</p></td></tr><tr><td><p><span class="term"><code class="constant">B_TIMESOURCE_STOP_IMMEDIATELY</code></span></p></td><td><p>Stop the time source immediately.</p></td></tr><tr><td><p><span class="term"><code class="constant">B_TIMESOURCE_SEEK</code></span></p></td><td><p>Seek the time source.</p></td></tr></tbody></table><p>These constants identify the various operations
<a class="link" href="BTimeSource.html#BTimeSource_TimeSourceOp" title="TimeSourceOp()"><code class="methodname">TimeSourceOp()</code></a>
will be called upon to handle.</p></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><hr /><div xmlns:d="http://docbook.org/ns/docbook"><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="BTimeSource_DefinedTypes"></a>Defined Types</h3></div></div></div><div class="section"><div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="titlepage"><div><div xmlns:d="http://docbook.org/ns/docbook"><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="time_source_op_info"></a>time_source_op_info</h4></div></div></div><a id="id1178600" class="indexterm"></a><pre class="programlisting definition c"><span class="type">struct time_source_op_info</span> {
   <span class="type">time_source_op</span> <code class="varname">op</code>;
   <span class="type">int32</span> <code class="varname">_reserved1</code>;
   <span class="type">bigtime_t</span> <code class="varname">real_time</code>;
   <span class="type">bigtime_t</span> <code class="varname">performance_time</code>;
   <span class="type">int32</span> <code class="varname">_reserved2</code>[6];
};</pre><p>Describes a request to
<a class="link" href="BTimeSource.html#BTimeSource_TimeSourceOp" title="TimeSourceOp()"><code class="methodname">TimeSourceOp()</code></a>.</p><table class="variablelist fields"><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><p><span class="term"><code class="varname">op</code></span></p></td><td><p>Indicates the operation to be performed.</p></td></tr><tr><td><p><span class="term"><code class="varname">real_time</code></span></p></td><td><p>Indicates the time at which the request is to be filled
(this is the <code class="parameter">atRealTime</code> argument passed to the
<a class="link" href="BMediaRoster.html" title="BMediaRoster"><code class="classname">BMediaRoster</code></a> functions
<a class="link" href="BMediaRoster.html#BMediaRoster_SeekTimeSource" title="SeekTimeSource()"><code class="methodname">SeekTimeSource()</code></a>,
<a class="link" href="BMediaRoster.html#BMediaRoster_StopTimeSource"><code class="methodname">StopTimeSource()</code></a>, or
<a class="link" href="BMediaRoster.html#BMediaRoster_StartTimeSource" title="StartTimeSource(), StopTimeSource()"><code class="methodname">StartTimeSource()</code></a>).</p></td></tr><tr><td><p><span class="term"><code class="varname">performance_time</code></span></p></td><td><p>Is the <code class="parameter">newPerformanceTime</code> argument passed to
<a class="link" href="BMediaRoster.html#BMediaRoster_SeekTimeSource" title="SeekTimeSource()"><code class="methodname">SeekTimeSource()</code></a>.</p></td></tr></tbody></table></div></div></div><div id="footer"><hr /><div id="footerT">Prev: <a href="BTimedEventQueue.html">BTimedEventQueue</a>  Up: <a href="TheMediaKit.html">The Media Kit</a>  Next: <a href="TheMediaKit_Functions.html">Functions</a> </div><div id="footerB"><div id="footerBL"><a href="BTimedEventQueue.html" title="BTimedEventQueue"><img src="./images/navigation/prev.png" alt="Prev" /></a> <a href="TheMediaKit.html" title="The Media Kit"><img src="./images/navigation/up.png" alt="Up" /></a> <a href="TheMediaKit_Functions.html" title="Functions"><img src="./images/navigation/next.png" alt="Next" /></a></div><div id="footerBR"><div><a href="http://www.haiku-os.org"><img src="./images/People_24.png" alt="haiku-os.org" title="Visit The Haiku Website" /></a></div><div class="navighome" title="Home"><a accesskey="h" href="index.html"><img src="./images/navigation/home.png" alt="Home" /></a></div></div><div id="footerBC"><a href="http://www.access-company.com/home.html" title="ACCESS Co."><img alt="Access Company" src="./images/access_logo.png" /></a></div></div></div><div id="licenseFooter"><div id="licenseFooterBL"><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="Creative Commons License"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-nc-nd/3.0/88x31.png" /></a></div><div id="licenseFooterBR"><a href="./LegalNotice.html">Legal Notice</a></div><div id="licenseFooterBC"><span id="licenseText">This work is licensed under a
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative
          Commons Attribution-Non commercial-No Derivative Works 3.0 License</a>.</span></div></div><!-- Fathom -->
<script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, 'https://metrics.haiku-os.org/tracker.js', 'fathom');
fathom('trackPageview');
</script>
<!-- / Fathom --></body></html>
